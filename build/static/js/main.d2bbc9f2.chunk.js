(window["webpackJsonpfirebase-demo"]=window["webpackJsonpfirebase-demo"]||[]).push([[0],{121:function(e,t,n){},122:function(e,t,n){},123:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),i=n.n(o),s=n(25),u=n(6),c=n(15),l=n(22),m=n(23),d=n(26),p=n(24),f=n(5),g=n(27),b=n(7),h=n(3),v=n.n(h),y=n(12);function w(){var e=Object(u.a)(["\n  font-size:8px;\n  margin-left:0.5rem;\n"]);return w=function(){return e},e}function E(){var e=Object(u.a)(['\n  width:100%;\n  height:8rem;\n  overflow:hidden auto;\n  form{\n    display:flex;\n    input[type="submit"]{\n      border:0.2px solid rgb(169, 169, 169);\n      flex-basis:15%;\n      font-weight:bold;\n      font-family: LiHeiPro,Microsoft JhengHei;\n      background-color: rgb(235, 232, 232);\n      cursor: pointer;\n      &:hover{\n        background-color: rgb(177, 177, 177);\n      }\n    }\n  }\n  textarea{\n    width:100%;\n    height:4rem;\n    resize:none;\n    padding:0;\n    margin:0;\n    padding:0.5rem\n  }\n']);return E=function(){return e},e}function O(){var e=Object(u.a)(["\n  width:100%;\n  max-height:20rem;\n  display:flex;\n  flex-direction:column;\n  justify-content:flex-start;\n  align-items:flex-start;\n  background-color:white;\n  overflow-y:auto;\n  &::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\n    border-radius: 10px;\n    background-color: #F5F5F5;\n  }\n\n  &::-webkit-scrollbar {\n    width: 6px;\n    height: 6px;\n    background-color: #F5F5F5;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    border-radius: 10px;\n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);\n    background-color: #555;\n  }\n  &>div{\n    padding:0.5rem\n  }\n  span{\n    font-weight:bold;\n  }\n"]);return O=function(){return e},e}function j(){var e=Object(u.a)(["\n  display:flex;\n  justify-content:space-between;\n  align-items:center;\n  background-color: rgb(235, 232, 232);\n  padding:8px;\n  border-top-left-radius:8px;\n  border-top-right-radius:8px;\n"]);return j=function(){return e},e}function k(){var e=Object(u.a)(["\n  width:80%;\n  display:flex;\n  position:absolute;\n  top:40%;\n  left:50%;\n  transform:translate(-50%, -50%);\n  -ms-transform:translate(-50%, -50%);\n  -moz-transform:translate(-50%, -50%);\n  -webkit-transform:translate(-50%, -50%);\n  -o-transform:translate(-50%, -50%);\n  flex-direction:column;\n  justify-content:center;\n  align-items:center;\n  &>div{\n    width:100%;\n  }\n"]);return k=function(){return e},e}var C=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e)))._isMounted=!1,n.state={chatLogs:[],submitContent:"",colorList:["#ff5e00","#53b800","#045ba1","#3403bb","#3403bb","#960075","#790028","#bd0000","#0383a3","#c08300"]},n.logout=n.logout.bind(Object(f.a)(n)),n.submitData=n.submitData.bind(Object(f.a)(n)),n.handleChange=n.handleChange.bind(Object(f.a)(n)),n.onEnterPress=n.onEnterPress.bind(Object(f.a)(n)),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this;v.a.firestore().collection("ChatroomLogs").orderBy("CreateTime","asc").onSnapshot({},(function(n){var a=[];n.docs.forEach((function(e){a.push({log:e})})),t._isMounted&&(t.setState({chatLogs:a}),e.refs.chatroomContent.scrollTop=e.refs.chatroomContent.scrollHeight)}),(function(e){console.log("firestore onSnapshot error",e)}))}},{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"submitData",value:function(e){e.preventDefault();var t=v.a.firestore(),n=this.state.submitContent,a=this.props.name;this.setState({submitContent:""}),t.collection("ChatroomLogs").add({Name:a,Content:n,CreateTime:(new Date).toISOString()})}},{key:"logout",value:function(){this.props.setName(""),v.a.auth().signOut()}},{key:"onEnterPress",value:function(e){13===e.keyCode&&!1===e.shiftKey&&(e.preventDefault(),this.refs.submitBtn.click())}},{key:"handleChange",value:function(e){var t=e.currentTarget.getAttribute("name"),n=e.currentTarget.value;this.setState(Object(c.a)({},t,n))}},{key:"render",value:function(){var e=this,t=this.state,n=t.chatLogs,a=t.submitContent,o=this.props.name;return console.log(o.charCodeAt()),r.a.createElement(x,null,r.a.createElement(y.Animated,{animationIn:"bounceInDown",animationInDelay:500,animationOut:"fadeOut",isVisible:o.length>0},r.a.createElement(S,null,r.a.createElement("span",null,"\u804a\u5929\u5ba4-",o),r.a.createElement("button",{onClick:this.logout},"X")),r.a.createElement(N,{ref:"chatroomContent"},r.a.createElement("div",null,n.map((function(e,t){return r.a.createElement(y.Animated,{animationIn:"fadeIn",isVisible:!0,key:t},r.a.createElement("div",null,r.a.createElement("span",null,e.log.data().Name),": ",e.log.data().Content,r.a.createElement(I,null,new Date(e.log.data().CreateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))))})))),r.a.createElement(D,null,r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){return e.submitData(t)}},r.a.createElement("textarea",{name:"submitContent",onKeyDown:function(t){return e.onEnterPress(t)},onChange:function(t){return e.handleChange(t)},value:a}),r.a.createElement("input",{type:"submit",value:"\u9001\u51fa",ref:"submitBtn"}))))))}}]),t}(a.Component),x=b.a.div(k()),S=b.a.div(j()),N=b.a.div(O()),D=b.a.div(E()),I=b.a.span(w());function T(){var e=Object(u.a)(['\n  display:flex;\n  flex-direction:row;\n  color:white;\n  div{\n    text-align:center;\n    margin-top:1rem;\n    input[type="submit"],input[type="button"]{\n      width:120px;\n      padding:0.4rem 0;\n      border:none;\n      border-radius:5px;\n      background-color: rgb(235, 232, 232);\n      cursor: pointer;\n      &:hover{\n        background-color: rgb(177, 177, 177);\n      }\n    }\n  }\n  &.registerDiv{\n    input[type="submit"],input[type="button"]{\n      width:8rem;\n      padding:0.4rem 0;\n      margin:0.5rem;\n    }\n  }\n  .errorMsg{\n    color:red;\n  }\n  .regText{\n    text-decoration:underline;\n    cursor: pointer;\n  }\n']);return T=function(){return e},e}function M(){var e=Object(u.a)(["\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  -moz-transform: translate(-50%, -50%);\n  -webkit-transform: translate(-50%, -50%);\n  -o-transform: translate(-50%, -50%);\n"]);return M=function(){return e},e}function _(){var e=Object(u.a)(["\n  width:100%;\n  display:flex;\n  flex-direction:column;\n  justify-content:center;\n  align-items:center;\n"]);return _=function(){return e},e}var P=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={account:"",password:"",errorMsg:"",reg_userName:"",reg_account:"",reg_password:"",isRegister:!1},n.login=n.login.bind(Object(f.a)(n)),n.saveNameToStore=n.saveNameToStore.bind(Object(f.a)(n)),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){var e=this;v.a.auth().onAuthStateChanged((function(t){t?e.props.setName(v.a.auth().currentUser.displayName):console.log("not login")}))}},{key:"saveNameToStore",value:function(e){return this.props.setName(e),!1}},{key:"login",value:function(e){var t=this;e.preventDefault();var n=this.state,a=n.account,r=n.password;v.a.auth().setPersistence(v.a.auth.Auth.Persistence.LOCAL).then((function(){v.a.auth().signInWithEmailAndPassword(a,r).then((function(){var e=v.a.auth().currentUser;null!==e&&(t.saveNameToStore(e.displayName),t.setState({errorMsg:""}))})).catch((function(e){console.log(e),t.setState({errorMsg:e.message||"\u767b\u5165\u5931\u6557\uff01"})}))}))}},{key:"register",value:function(e){var t=this;e.preventDefault();var n=this.state,a=n.reg_account,r=n.reg_password,o=n.reg_userName;v.a.auth().createUserWithEmailAndPassword(a,r).then((function(){var e=v.a.auth().currentUser;null!==e&&e.updateProfile({displayName:o}).then((function(){t.saveNameToStore(o),t.setState({errorMsg:"",isRegister:!1,reg_userName:"",reg_account:"",reg_password:""})}))})).catch((function(e){t.setState({errorMsg:e.message||"\u8a3b\u518a\u5931\u6557\uff01"})}))}},{key:"handleChange",value:function(e){var t=e.currentTarget.getAttribute("name"),n=e.currentTarget.value;this.setState(Object(c.a)({},t,n))}},{key:"switchToRegister",value:function(e){this.setState({error:"",isRegister:e})}},{key:"render",value:function(){var e=this,t=this.state,n=t.account,a=t.password,o=t.errorMsg,i=t.isRegister,s=t.reg_account,u=t.reg_password,c=t.reg_userName,l=this.props,m=l.name,d=l.setName;return console.log(m),r.a.createElement(A,null,r.a.createElement(L,null,i?r.a.createElement("div",null,r.a.createElement(R,{className:"registerDiv",animationIn:"bounceInLeft",isVisible:!0},r.a.createElement("form",{onSubmit:function(t){return e.register(t)}},r.a.createElement(y.Animated,{className:"errorMsg",animationIn:"shake",animationOut:"fadeOut",animationInDuration:200,isVisible:o.length>0},o),r.a.createElement("div",null,r.a.createElement("span",null,"\u66b1\u7a31\uff1a"),r.a.createElement("input",{type:"text",name:"reg_userName",value:c,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u5e33\u865f\uff1a"),r.a.createElement("input",{type:"text",name:"reg_account",value:s,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u5bc6\u78bc\uff1a"),r.a.createElement("input",{type:"password",name:"reg_password",value:u,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit",value:"\u8a3b\u518a\u4e26\u767b\u5165"}),r.a.createElement("input",{type:"button",value:"\u8fd4\u56de",onClick:function(){return e.switchToRegister(!1)}}))))):r.a.createElement(R,{animationIn:"bounceInLeft",animationOut:"fadeOut",animationOutDuration:300,isVisible:!m.length>0},r.a.createElement("form",{onSubmit:function(t){return e.login(t)}},r.a.createElement(y.Animated,{className:"errorMsg",animationIn:"shake",animationOut:"fadeOut",animationInDuration:200,isVisible:o.length>0},o),r.a.createElement("div",null,r.a.createElement("span",null,"\u5e33\u865f\uff1a"),r.a.createElement("input",{type:"text",name:"account",value:n,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",null,r.a.createElement("span",null,"\u5bc6\u78bc\uff1a"),r.a.createElement("input",{type:"password",name:"password",value:a,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit",value:"\u767b\u5165"})),r.a.createElement("div",null,"\u9084\u6c92\u6709\u5e33\u865f\u55ce\uff1f",r.a.createElement("span",{onClick:function(){return e.switchToRegister(!0)},className:"regText"},"\u9ede\u6b64\u8a3b\u518a"))))),m&&r.a.createElement(C,{name:m,setName:d}))}}]),t}(a.Component),A=b.a.div(_()),L=b.a.div(M()),R=Object(b.a)(y.Animated)(T()),z="SETNAME";var F=Object(s.b)((function(e){return{name:e.setter.name}}),(function(e){return{setName:function(t){e(function(e){return{type:z,name:e}}(t))}}}))(P),U=n(14);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var B={name:""};var W=Object(U.b)({setter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){default:return e;case z:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{name:t.name})}}}),H=(n(121),n(122),Object(U.c)(W));v.a.initializeApp({apiKey:"AIzaSyCwwRAzQryiTZm3RacMuIuguNZvpRxsOSk",authDomain:"mytestproject-5e25f.firebaseapp.com",databaseURL:"https://mytestproject-5e25f.firebaseio.com",projectId:"mytestproject-5e25f",storageBucket:"mytestproject-5e25f.appspot.com",messagingSenderId:"916908850775",appId:"1:916908850775:web:aecabcba0493933ec82d12",measurementId:"G-3FCH0ZS44K"}),i.a.render(r.a.createElement(s.a,{store:H},r.a.createElement(F,null)),document.getElementById("root"))},53:function(e,t,n){e.exports=n(123)}},[[53,1,2]]]);
//# sourceMappingURL=main.d2bbc9f2.chunk.js.map